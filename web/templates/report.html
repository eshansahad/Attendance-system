{% extends "base.html" %}

{% set active_page = "reports" %}

{% block title %}Reports & Issues - Smart Attend{% endblock %}

{% block header_title %}
Reports & Issues
{% endblock %}

{% block content %}

<h3 style="margin-bottom: 15px; color: #ff9b44;">
    <i class="fas fa-exclamation-circle"></i> Student Reports / Complaints
</h3>

<div class="table-card" style="margin-bottom: 40px;">
    <table>
        <thead>
            <tr>
                <th>Student</th>
                <th>Date</th>
                <th>Issue Type</th>
                <th>Description</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody>
        {% if complaints %}
            {% for issue in complaints %}
            <tr>
                <td style="font-weight:600;">{{ issue.name }}</td>
                <td>{{ issue.date }}</td>
                <td>
                    <span style="background: rgba(59,130,246,.2); color:#60a5fa; padding:4px 8px; border-radius:4px; font-size:12px;">
                        {{ issue.type }}
                    </span>
                </td>
                <td style="color:#cbd5e1;">{{ issue.description }}</td>
                <td>
                    {% if issue.status == 'Pending' %}
                        <div style="display:flex; gap:6px;">
                            <a href="/complaint/{{ issue.id }}/approve"
                               class="btn"
                               style="background:#10b981; color:white; padding:6px 10px; font-size:12px;">
                                <i class="fas fa-check"></i> Accept
                            </a>
                            <a href="/complaint/{{ issue.id }}/reject"
                               class="btn"
                               style="background:#ef4444; color:white; padding:6px 10px; font-size:12px;">
                                <i class="fas fa-times"></i> Deny
                            </a>
                        </div>
                    {% elif issue.status == 'Resolved' %}
                        <span style="color:#10b981; font-weight:600;">
                            <i class="fas fa-check-circle"></i> Resolved
                        </span>
                    {% else %}
                        <span style="color:#ef4444; font-weight:600;">
                            <i class="fas fa-times-circle"></i> Rejected
                        </span>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="5" style="text-align:center; color:#94a3b8;">
                    No complaints submitted.
                </td>
            </tr>
        {% endif %}
        </tbody>
    </table>
</div>

<div style="display:flex; justify-content:flex-end; margin-bottom:25px;">
    <a href="/send_absentees" class="btn btn-primary">
        <i class="fas fa-envelope"></i> Send Absentee Report
    </a>
</div>

<h3 style="margin-bottom: 15px;">
    <i class="fas fa-calendar-day"></i> Daily Attendance Log
</h3>

<div class="table-card">
    <table>
        <thead>
            <tr>
                <th>Student Name</th>
                <th>Status</th>
                <th>Time In</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
        {% for row in attendance_logs %}
            <tr>
                <td>{{ row.name }}</td>
                <td style="color: {{ '#10b981' if row.status=='Present' else '#ef4444' }};">
                    {{ row.status }}
                </td>
                <td>{{ row.time }}</td>
                <td>{{ row.date }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

{% endblock %}
